{
  "meta:license": [
    "Copyright 2018 Adobe Systems Incorporated. All rights reserved.",
    "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
    "you may not use this file except in compliance with the License. You may obtain a copy",
    "of the License at https://creativecommons.org/licenses/by/4.0/"
  ],
  "$id": "https://ns.adobe.com/xdm/firefly/extensionpoint",
  "$schema": "http://json-schema.org/draft-06/schema#",
  "title": "Extension Point",
  "meta:extensible": false,
  "meta:abstract": false,
  "type": "object",
  "description": "Describes an extension point to be implemented by an extension.",
  "definitions": {
    "extension": {
      "properties": {
        "xdm:id": {
          "title": "ID",
          "type": "string",
          "meta:immutable": true,
          "meta:usereditable": false,
          "description": "Unique identifier of the extension. This id is assigned by the service and cannot be modified."
        },
        "xdm:title": {
          "title": "Title",
          "type": "string",
          "description": "Title (aka short description) of the extension point"
        },
        "xdm:description": {
          "title": "Description",
          "type": "string",
          "description": "Longer description of the extension point"
        },
        "icon": {
          "title": "Icon",
          "type": "string",
          "format": "uri",
          "description": "Link to an icon representing this extension."
        },
        "documentation": {
          "title": "Documentation",
          "type": "string",
          "format": "uri",
          "description": "Developer documentation helping with the implementation of this extension point"
        },
        "vendor": {
          "title": "Documentation",
          "type": "string",
          "format": "uri",
          "description": "name of the IMS Org/Publisher submitting the extension. this field is preset by the extension registry upon submission of the descriptor."
        },
        "endpoints": {
          "title": "Endpoints",
          "description": "Endpoints by Extension Points implementing the respective extension point operation. This object is keyed by Extension Point xdm:id",
          "patternProperties": {
            ".*": {
              "$ref": "#/definitions/extensionpoint"
            }
          },
          "examples": [
            {
              "extPoint/v1": { "opIdA": { "href": "https://example.org/hrefV1" } },
              "extPoint/v2": { "opIdA": { "href": "https://example.org/hrefV2" } }
            }
          ]
        }
      },
      "patternProperties": {
        ".*": {}
      },
      "required": ["xdm:title", "endpoints"]
    },
    "extensionpoint": {
      "description": "Endpoints implementing a single Extension Point. This object is keyed by the operationID of the Extension Points API specification",
      "type": "object",
      "patternProperties": {
        ".*": {
          "$ref": "#/definitions/endpoints"
        }
      },
      "examples": [
        { "opIdA": { "href": "https://example.org/href" } },
        { "opIdX": [ { "href": "https://example.org/href1", "variant": 1 }, { "href": "https://example.org/href2", "variant": 2 } ] }
      ]
    },
    "endpoints": {
      "title": "Endpoint(s)",
      "description": "One or more endpoints as defined by extension point API specification for the Extension Point's operation.",
      "oneOf": [
        {
          "$ref": "#/definitions/endpoint"
        },
        {
          "type": "array",
          "items": {
            "$ref": "#/definitions/endpoint"
          },
          "minItems": 1
        }
      ],
      "examples": [
        { "href": "https://example.org/href" },
        [ { "href": "https://example.org/href1", "variant": 1 }, { "href": "https://example.org/href2", "variant": 2 } ]
      ]
    },
    "endpoint": {
      "title": "Endpoint Descriptor",
      "description": "Describes a single end point implementing the prescribed extension point AP",
      "properties": {
        "href": {
          "title": "End point URL",
          "description": "The URL which may be an URI template as described by the API specification",
          "type": "string",
          "format": "uri-template"
        }
      },
      "patternProperties": {
        ".*": {
          "title": "End point descriptor properties",
          "description": "End point descriptor properties can be prescribed by the Extension Point API specification or by the Extension Point documentation to help the service selecting amongst multiple end points of the same endpoint ID",
          "type": ["string", "boolean", "number", "null"]
        }
      },
      "required": ["href"],
      "examples": [
        { "href": "https://example.org/href" },
        { "href": "https://example.org/href", "lang": "de", "otherProp": "withValue" }
      ]
    }
  },
  "allOf": [
    {
      "$ref": "#/definitions/extension"
    },
    {
      "$ref": "https://ns.adobe.com/xdm/firefly/common#/definitions/common-properties"
    }
  ],
  "meta:status": "experimental"
}
